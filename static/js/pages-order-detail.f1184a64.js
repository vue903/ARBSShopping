(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-order-detail"],{"0473":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"content"},[n("topNav",{attrs:{text:"订单详情"}}),n("v-uni-view",{staticClass:"order-status"},[e._v("订单状态:"),n("v-uni-text",[e._v(e._s(e.isType(e.orderList.status)))])],1),void 0!=e.orderList.goodImg?n("v-uni-view",{staticClass:"shoplist"},[n("ShopItemOne",{attrs:{already:e.orderList}})],1):e._e(),n("v-uni-view",{staticClass:"buy-shop-list",staticStyle:{padding:"20rpx 0"}},[n("v-uni-view",{staticClass:"buy-shop-item"},[n("v-uni-view",{staticClass:"shop-item-left"},[e._v("商品名称")]),n("v-uni-view",{staticClass:"shop-item-right"},[e._v(e._s(e.shopList.goodName))])],1),n("v-uni-view",{staticClass:"buy-shop-item"},[n("v-uni-view",{staticClass:"shop-item-left"},[e._v("收货人")]),n("v-uni-view",{staticClass:"shop-item-right"},[e._v(e._s(e.shopList.name))])],1),n("v-uni-view",{staticClass:"buy-shop-item"},[n("v-uni-view",{staticClass:"shop-item-left"},[e._v("电话")]),n("v-uni-view",{staticClass:"shop-item-right"},[e._v(e._s(e.shopList.phone))])],1),n("v-uni-view",{staticClass:"buy-shop-item"},[n("v-uni-view",{staticClass:"shop-item-left"},[e._v("收货地址")]),n("v-uni-view",{staticClass:"shop-item-right"},[e._v(e._s(e.shopList.address))])],1),n("v-uni-view",{staticClass:"buy-shop-item"},[n("v-uni-view",{staticClass:"shop-item-left"},[e._v("应付金额")]),n("v-uni-view",{staticClass:"shop-item-right"},[e._v(e._s(e.orderList.payAmount)+"$")])],1),n("v-uni-view",{staticClass:"buy-shop-item"},[n("v-uni-view",{staticClass:"shop-item-left"},[e._v("订单号")]),n("v-uni-view",{staticClass:"shop-item-right"},[e._v(e._s(e.orderList.payId))])],1),n("v-uni-view",{staticClass:"buy-shop-item"},[n("v-uni-view",{staticClass:"shop-item-left"},[e._v("订单生成时间")]),n("v-uni-view",{staticClass:"shop-item-right"},[e._v(e._s(e.formatDate(e.orderList.logTime)))])],1)],1),0==e.orderList.status?n("v-uni-view",{staticClass:"detailBtn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.postBuyOne.apply(void 0,arguments)}}},[e.approveUsdt?n("v-uni-view",{staticClass:"text"},[e._v("确认支付")]):n("v-uni-view",{staticClass:"text"},[e._v(e._s(e.$t("Approve")))])],1):e._e(),n("w-loading",{ref:"loading",attrs:{text:"",mask:"true",click:"false"}})],1)},i=[]},"0ab6":function(e,t,n){"use strict";(function(e){n("6a54");var a=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("c9b5"),n("bf0f"),n("ab80"),n("e966"),n("e838"),n("64aa"),n("d4b5");var i=a(n("2634")),s=a(n("2fdc")),r=a(n("dc10")),o=n("493a"),u=a(n("b587")),d=a(n("16f5")),f=a(n("5084")),p=n("64b3"),l=a(n("81a5")),c=a(n("ae3d")),y=a(n("32ea")),v=a(n("ed07")),m={data:function(){return{myAddress:"",orderList:{},orderId:"",shopList:{},usdtAllowanceB:0,approveUsdt:!1,lamount:"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"}},components:{ShopItemOne:d.default,topNav:f.default,myAddress:u.default,wLoading:v.default},onLoad:function(e){var t=this;this.postOrderInfo(e.orderId),this.Init((function(){uni.setStorageSync("address",t.myAddress),t.getAllowance()}))},methods:{clickApprove:function(){var e=this;return(0,s.default)((0,i.default)().mark((function t(){var n;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$refs.loading.open(),t.next=3,e.usdtContract.approve(e.payAddress,e.lamount).catch((function(t){e.$refs.loading.close(),(0,r.default)({title:"error",text:t.reason,icon:"error"})}));case 3:if(n=t.sent,!n){t.next=17;break}return t.prev=5,t.next=8,n.wait();case 8:e.$refs.loading.close(),(0,r.default)({title:e.$t("appoveSuccess"),icon:"success"}),e.getAllowance(),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](5),e.$refs.loading.close(),(0,r.default)({title:"error",text:t.t0.reason,icon:"error"});case 17:case"end":return t.stop()}}),t,null,[[5,13]])})))()},mobileFilter1:function(e){var t=e.toString(),n=o.ethers.formatUnits(t);return parseInt(n)===parseFloat(n)?parseInt(n):Number(n).toFixed(2)},getAllowance:function(){var t=this;this.usdtContract.allowance(this.myAddress,this.payAddress).then((function(n){var a=t.mobileFilter1(n);e.log(a),"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"==n._hex?t.usdtAllowanceB="999999999999999999":t.usdtAllowanceB=a,parseInt(a)<=parseInt(0)?t.approveUsdt=!1:t.approveUsdt=!0})).catch((function(t){e.log(t),uni.showToast({title:t,icon:"none"})}))},Init:function(t){var n=this;return(0,s.default)((0,i.default)().mark((function a(){var s,r,u;return(0,i.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if("undefined"!==typeof window.ethereum){a.next=5;break}e.log("请安装MetaMask"),uni.showToast({title:n.$t("shop55"),icon:"none"}),a.next=19;break;case 5:return s=new o.ethers.BrowserProvider(window.ethereum),a.next=8,s.getSigner();case 8:return r=a.sent,n.contract=new o.ethers.Contract(n.payAddress,c.default,r),n.usdtContract=new o.ethers.Contract(n.usdtContractAddress,y.default,r),a.next=13,s.send("eth_requestAccounts",[]);case 13:return u=a.sent,a.next=16,window.ethereum.request({method:"eth_requestAccounts"});case 16:n.myAddress=u[0],uni.getStorageSync("address").toLowerCase()!=n.myAddress.toLowerCase()&&(uni.removeStorageSync("address"),uni.removeStorageSync("bindAddres"),uni.removeStorageSync("hash"),uni.removeStorageSync("id")),t();case 19:case"end":return a.stop()}}),a)})))()},toUSDCUnits:function(e){return o.ethers.parseUnits(e.toString(),6)},postBuyOne:function(){var t=this;return(0,s.default)((0,i.default)().mark((function n(){var a,s,r;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.approveUsdt){n.next=3;break}return t.clickApprove(),n.abrupt("return");case 3:if(!(t.usdtAllowanceB<t.orderList.payAmount)){n.next=7;break}return a=t,uni.showModal({title:a.$t("package18"),content:a.$t("package19"),cancelText:a.$t("package21"),confirmText:a.$t("package20"),success:function(e){e.confirm?a.clickApprove():e.cancel}}),n.abrupt("return");case 7:return t.$refs.loading.open(),s=t.toUSDCUnits(t.orderList.payAmount),n.next=11,t.contract.buyOne(t.orderList.payId,s).catch((function(n){e.log(n),t.$refs.loading.close();var a=JSON.parse(JSON.stringify(n));uni.showToast({title:a.reason,icon:"none"})}));case 11:if(r=n.sent,!r){n.next=27;break}return n.prev=13,n.next=16,r.wait();case 16:t.$refs.loading.close(),uni.showToast({title:t.$t("success"),icon:"none"}),t.$refs.popup.close(),n.next=27;break;case 21:n.prev=21,n.t0=n["catch"](13),e.log(n.t0),t.$refs.loading.close(),t.$refs.popup.close(),uni.showToast({title:n.t0.toString(),icon:"none"});case 27:case"end":return n.stop()}}),n,null,[[13,21]])})))()},times:function(e,t){if(void 0!=e)return(0,l.default)(e).times((0,l.default)(t)).toString()},postOrderInfo:function(e){var t=this;(0,p.getOrderInfo)({payCode:e}).then((function(e){0==e.code?(t.orderList=e.payInfo[0],t.shopList=e.goodInfo[0]):uni.showToast({title:e.msg,icon:"none"})}))},isType:function(e){return 0==e?"待支付":1==e?"已支付":"支付金额异常"},formatDate:function(e){var t=1e3*e;(new Date).getTime(),e=new Date;e.setTime(t);var n=e.getFullYear(),a=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,i=e.getDate()<10?"0"+e.getDate():e.getDate(),s=e.getHours()<10?"0"+e.getHours():e.getHours(),r=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),o=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds(),u=n+"-"+a+"-"+i+" "+s+":"+r+":"+o;return u}}};t.default=m}).call(this,n("ba7c")["default"])},"16f5":function(e,t,n){"use strict";n.r(t);var a=n("858b"),i=n("d317");for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);n("2f21");var r=n("828b"),o=Object(r["a"])(i["default"],a["b"],a["c"],!1,null,"320e746a",null,!1,a["a"],void 0);t["default"]=o.exports},"24f7":function(e,t,n){var a=n("c86c");t=a(!1),t.push([e.i,".content[data-v-31c367be]{width:100%;background-color:#f2f6ff;height:auto;min-height:100vh;padding-top:%?120?%;box-sizing:border-box}.order-status[data-v-31c367be]{height:%?100?%;background:#fff;font-size:%?30?%;line-height:%?100?%;padding:0 %?30?%;border-top:%?1?% solid #e5e5e5}.order-status uni-text[data-v-31c367be]{color:#00c3f5}.addressBox[data-v-31c367be]{margin-top:%?20?%}.shoplist[data-v-31c367be]{background:#fff;margin-top:%?20?%}\n/* 列表信息 */.buy-shop-list[data-v-31c367be]{background:#fff;border-top:%?1?% solid #e5e5e5}.buy-shop-item[data-v-31c367be]{display:flex;justify-content:space-between;min-height:%?80?%;font-size:%?24?%;margin:0 %?20?%;align-items:center}.shop-item-left[data-v-31c367be]{color:#333;display:flex;align-items:center}.shop-item-right[data-v-31c367be]{color:#999;display:flex;align-items:center}.shop-item-right i[data-v-31c367be]{font-size:16px;padding-top:2px}.shop-item-right uni-radio[data-v-31c367be]{-webkit-transform:scale(.7);transform:scale(.7)}.buy-shop-item uni-input[data-v-31c367be]{width:100%;background:#f4f4f4;height:%?70?%;border-radius:%?70?%;font-size:%?24?%;text-indent:%?30?%}.shop-item-right .btn[data-v-31c367be]{width:%?100?%;height:%?40?%;background:linear-gradient(90deg,#7784ff,#5993f8);border-radius:%?10?%;font-family:Microsoft YaHei;font-weight:700;font-size:%?26?%;color:#fff;text-align:center;line-height:%?40?%}.detailBtn[data-v-31c367be]{margin:%?50?% %?40?% %?0?%;background-color:#0bbbef;padding:%?20?%;border-radius:%?20?%}.detailBtn .text[data-v-31c367be]{text-align:center;color:#fff}",""]),e.exports=t},"2f21":function(e,t,n){"use strict";var a=n("e335"),i=n.n(a);i.a},"32ea":function(e){e.exports=JSON.parse('[{"inputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"string","name":"symbol","type":"string"},{"internalType":"contract IERC20","name":"_usdt","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"owner","type":"address"},{"indexed":true,"internalType":"address","name":"spender","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":true,"internalType":"address","name":"to","type":"address"},{"indexed":false,"internalType":"uint256","name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"stateMutability":"payable","type":"fallback"},{"inputs":[{"internalType":"address","name":"owner","type":"address"},{"internalType":"address","name":"spender","type":"address"}],"name":"allowance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"approve","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"burn","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"decimals","outputs":[{"internalType":"uint8","name":"","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"subtractedValue","type":"uint256"}],"name":"decreaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"spender","type":"address"},{"internalType":"uint256","name":"addedValue","type":"uint256"}],"name":"increaseAllowance","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"mint","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"replacement","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"trBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transfer","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"from","type":"address"},{"internalType":"address","name":"to","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"transferFrom","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"usdt","outputs":[{"internalType":"contract IERC20","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"stateMutability":"payable","type":"receive"}]')},6298:function(e,t,n){"use strict";var a=n("7e919"),i=n.n(a);i.a},"758c":function(e,t,n){"use strict";n.r(t);var a=n("0ab6"),i=n.n(a);for(var s in a)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(s);t["default"]=i.a},"7e919":function(e,t,n){var a=n("24f7");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=n("967d").default;i("118f9cf3",a,!0,{sourceMap:!1,shadowMode:!1})},"858b":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"itemlist"},[n("v-uni-view",{staticClass:"buy-shop-info"},[n("v-uni-image",{attrs:{src:JSON.parse(e.already.goodImg)[0],mode:""}}),n("v-uni-view",{staticClass:"shop-info-text"},[n("v-uni-view",{staticClass:"shop-title"},[e._v(e._s(e.already.goodName))]),n("v-uni-view",{staticClass:"shop-attr"},[n("v-uni-text",{staticClass:"name"},[e._v(e._s(e.already.name))]),e._v(e._s(e.already.phone))],1),n("v-uni-view",{staticClass:"shop-attr"},[e._v(e._s(e.already.address))]),n("v-uni-view",{staticClass:"shop-price-num"},[n("v-uni-text",{staticClass:"price"},[e._v("$"+e._s(e.already.goodAmount))]),n("v-uni-text",{staticClass:"num"},[e._v("×"+e._s(e.already.goodNum))])],1)],1)],1)],1)},i=[]},"864a":function(e,t,n){var a=n("c86c");t=a(!1),t.push([e.i,".itemlist .buy-shop-info[data-v-320e746a]{border-top:%?1?% solid #e5e5e5}.itemlist .buy-shop-info[data-v-320e746a]:nth-of-type(1){border-top:none}.buy-shop-info[data-v-320e746a]{display:flex;padding:%?10?% %?0?%;margin:0 %?20?%;background:#fff}.buy-shop-info uni-image[data-v-320e746a]{width:%?200?%;height:%?200?%;margin-right:%?10?%;border-radius:%?30?%}.shop-info-text[data-v-320e746a]{flex:1}.shop-title[data-v-320e746a]{font-size:%?28?%;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;color:#333;-webkit-line-clamp:2;-webkit-box-orient:vertical}.shop-attr[data-v-320e746a]{font-size:%?24?%;color:#999;line-height:%?40?%}.shop-price-num[data-v-320e746a]{height:%?40?%;font-size:%?28?%;margin-top:%?10?%;display:flex;justify-content:space-between;margin-top:%?20?%}.shop-price-num .price[data-v-320e746a]{color:red}.shop-price-num .num[data-v-320e746a]{color:#999}.shop-attr .name[data-v-320e746a]{display:inline-block;width:auto;max-width:%?200?%}",""]),e.exports=t},d317:function(e,t,n){"use strict";n.r(t);var a=n("f733"),i=n.n(a);for(var s in a)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(s);t["default"]=i.a},e335:function(e,t,n){var a=n("864a");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=n("967d").default;i("1251a9a4",a,!0,{sourceMap:!1,shadowMode:!1})},ecda:function(e,t,n){"use strict";n.r(t);var a=n("0473"),i=n("758c");for(var s in i)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(s);n("6298");var r=n("828b"),o=Object(r["a"])(i["default"],a["b"],a["c"],!1,null,"31c367be",null,!1,a["a"],void 0);t["default"]=o.exports},f733:function(e,t,n){"use strict";n("6a54");var a=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(n("4491")),s={props:{num:{type:String,default:"0"},type:{type:String,default:"0"},already:{type:Object,default:{}},dialogImg:{type:String,default:""}},data:function(){return{}},components:{MyNum:i.default},created:function(){},methods:{}};t.default=s}}]);